/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.create;var h=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var d=a=>h(a,"__esModule",{value:!0});var k=(a,e)=>{d(a);for(var i in e)h(a,i,{get:e[i],enumerable:!0})},L=(a,e,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of y(e))!F.call(a,t)&&t!=="default"&&h(a,t,{get:()=>e[t],enumerable:!(i=m(e,t))||i.enumerable});return a},w=a=>L(d(h(a!=null?g(v(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var p=(a,e,i)=>new Promise((t,l)=>{var r=s=>{try{o(i.next(s))}catch(u){l(u)}},n=s=>{try{o(i.throw(s))}catch(u){l(u)}},o=s=>s.done?t(s.value):Promise.resolve(s.value).then(r,n);o((i=i.apply(a,e)).next())});k(exports,{default:()=>f});var c=w(require("obsidian"));function C(a,e){let i=Object.keys(e).map(t=>P(a,t,e[t]));return i.length===1?i[0]:function(){i.forEach(t=>t())}}function P(a,e,i){let t=a[e],l=a.hasOwnProperty(e),r=i(t);return t&&Object.setPrototypeOf(r,t),Object.setPrototypeOf(n,r),a[e]=n,o;function n(...s){return r===t&&a[e]===n&&o(),r.apply(this,s)}function o(){a[e]===n&&(l?a[e]=t:delete a[e]),r!==t&&(r=t,Object.setPrototypeOf(n,t||Function))}}var f=class extends c.Plugin{constructor(){super(...arguments);this.refreshLinkResolverCache=()=>{let e=this.app.metadataCache,i=e.metadataCache,t=e.fileCache,l={},r=this.app.vault.getAllLoadedFiles();for(let n of r)n instanceof c.TFile&&(e.uniqueFileLookup.add(n.name.toLowerCase(),n),l[n.path]=n);for(let n in t){let o=l[n],s=t[n];o&&i.hasOwnProperty(s.hash)&&e.linkResolverQueue.add(o)}};this.clearAliasCache=(0,c.debounce)(()=>{this.aliasCache=[]},2e3,!0)}onload(){return p(this,null,function*(){let e=this;this.aliasCache=[],this.patchMDCacheUninstaller=C(c.MetadataCache.prototype,{getFirstLinkpathDest(i){return function(t,l){let r=i.call(this,t,l);if(r)return r;try{let n=e.getFileByAlias(t);return n?n.file:null}catch(n){return null}}}}),this.register(this.patchMDCacheUninstaller),this.app.metadataCache.initialized&&this.refreshLinkResolverCache()})}onunload(){this.patchMDCacheUninstaller(),this.refreshLinkResolverCache()}getFileByAlias(e){return this.populateAliasCache(),this.aliasCache.find(i=>{var t;return((t=i.alias)==null?void 0:t.toLowerCase())===e.toLowerCase()})}populateAliasCache(){this.aliasCache.length||(this.aliasCache=this.app.metadataCache.getLinkSuggestions().filter(e=>e.alias)),this.clearAliasCache()}};
